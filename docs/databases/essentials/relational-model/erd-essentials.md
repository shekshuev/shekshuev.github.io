## 2. Основы проектирования баз данных

_(От хаоса к порядку: ER-моделирование и Нормализация)_

1.  **Жизненный цикл проектирования:**
    - **Концептуальный уровень:** Общение с заказчиком, выявление сущностей, "рисование квадратиков" (без типов данных).
    - **Логический уровень:** Превращение модели в конкретные таблицы, нормализация, разрешение связей M:M.
    - **Физический уровень:** Выбор конкретной СУБД (Postgres vs MySQL), типов данных (`int` vs `bigint`), создание индексов, партицирование.

2.  **ER-моделирование (Entity-Relationship):**
    - Нотация Питера Чена (классика) vs Нотация «Воронья лапка» (Crow’s Foot — индустриальный стандарт).
    - Сущности (сильные и слабые). Атрибуты (простые, составные).
    - Кардинальность связей (Обязательность и Множественность): «Ноль или один», «Один и только один», «От одного до многих».

3.  **Аномалии баз данных (Зачем нам нормализация?):**
    - Почему нельзя хранить всё в одной таблице Excel?
    - Аномалия вставки (Insertion Anomaly): Не можем добавить студента, пока он не выбрал курс.
    - Аномалия обновления (Update Anomaly): Сменили название кафедры в одной строке, а в остальных забыли -> данные разъехались.
    - Аномалия удаления (Deletion Anomaly): Удалили единственного сотрудника отдела -> информация об отделе исчезла совсем.

4.  **Нормализация: 1-я Нормальная форма (1НФ):**
    - Атомарность атрибутов: никаких списков через запятую в одной ячейке («Иванов, Петров, Сидоров»).
    - Отсутствие повторяющихся групп полей (`phone1`, `phone2`, `phone3`).
    - Наличие первичного ключа.

5.  **Нормализация: 2-я Нормальная форма (2НФ):**
    - Понятие функциональной зависимости.
    - Устранение частичной зависимости: все неключевые поля должны зависеть от _полного_ первичного ключа (актуально для составных ключей). Пример с таблицей «Заказы-Товары».

6.  **Нормализация: 3-я Нормальная форма (3НФ) и BCNF:**
    - Устранение транзитивной зависимости: атрибут зависит от атрибута, который зависит от ключа (Студент -> Группа -> Староста). Данные должны зависеть «от ключа, всего ключа и ничего кроме ключа» (Клятва Кодда).
    - Нормальная форма Бойса-Кодда (BCNF) — кратко для справки.

7.  **Практические приемы и Денормализация:**
    - Реализация связи «Многие-ко-многим» через ассоциативную таблицу (junction table).
    - Когда стоит нарушить правила нормализации? (Оптимизация чтения, Data Warehouse, JSONB в PostgreSQL).
    - Правила именования (Naming Conventions): `snake_case`, единственное/множественное число.
